<html>
  <head>
      <meta charset="utf-8">
    <title>Battleship</title>
    <style>
      table, div { font-size: x-large }
      td { padding: 2 !important; background-color: #0046FF; color: white;}
      .hit { color: #FF5E39 }     
      .glyphicon-unchecked { color: #0046FF }
    </style>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  </head>
    <body>
    <table border=1 cellspacing=2 cellpadding=2>
      <tr>
	<th></th>
	<th> 1</th>
	<th> 2</th>
	<th> 3</th>
	<th> 4</th>
	<th> 5</th>
	<th> 6</th>
	<th> 7</th>
	<th> 8</th>
	<th> 9</th>
	<th>10</th>
      </tr>
      <tr>
	<th>A</th>
	<td><span id="0_0" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(0,0)'></td>
	<td><span id="0_1" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(0,1)'></td>
	<td><span id="0_2" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(0,2)'></td>
	<td><span id="0_3" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(0,3)'></td>
	<td><span id="0_4" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(0,4)'></td>
	<td><span id="0_5" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(0,5)'></td>
	<td><span id="0_6" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(0,6)'></td>
	<td><span id="0_7" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(0,7)'></td>
	<td><span id="0_8" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(0,8)'></td>
	<td><span id="0_9" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(0,9)'></td>
      </tr>
      <tr>
	<th>B</th>
	<td><span id="1_0" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(1,0)'></td>
	<td><span id="1_1" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(1,1)'></td>
	<td><span id="1_2" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(1,2)'></td>
	<td><span id="1_3" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(1,3)'></td>
	<td><span id="1_4" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(1,4)'></td>
	<td><span id="1_5" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(1,5)'></td>
	<td><span id="1_6" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(1,6)'></td>
	<td><span id="1_7" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(1,7)'></td>
	<td><span id="1_8" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(1,8)'></td>
	<td><span id="1_9" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(1,9)'></td>
      </tr>
      <tr>
	<th>C</th>
	<td><span id="2_0" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(2,0)'></td>
	<td><span id="2_1" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(2,1)'></td>
	<td><span id="2_2" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(2,2)'></td>
	<td><span id="2_3" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(2,3)'></td>
	<td><span id="2_4" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(2,4)'></td>
	<td><span id="2_5" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(2,5)'></td>
	<td><span id="2_6" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(2,6)'></td>
	<td><span id="2_7" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(2,7)'></td>
	<td><span id="2_8" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(2,8)'></td>
	<td><span id="2_9" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(2,9)'></td>
      </tr>
      <tr>
	<th>D</th>
	<td><span id="3_0" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(3,0)'></td>
	<td><span id="3_1" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(3,1)'></td>
	<td><span id="3_2" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(3,2)'></td>
	<td><span id="3_3" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(3,3)'></td>
	<td><span id="3_4" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(3,4)'></td>
	<td><span id="3_5" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(3,5)'></td>
	<td><span id="3_6" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(3,6)'></td>
	<td><span id="3_7" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(3,7)'></td>
	<td><span id="3_8" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(3,8)'></td>
	<td><span id="3_9" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(3,9)'></td>
      </tr>
      <tr>
	<th>E</th>
	<td><span id="4_0" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(4,0)'></td>
	<td><span id="4_1" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(4,1)'></td>
	<td><span id="4_2" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(4,2)'></td>
	<td><span id="4_3" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(4,3)'></td>
	<td><span id="4_4" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(4,4)'></td>
	<td><span id="4_5" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(4,5)'></td>
	<td><span id="4_6" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(4,6)'></td>
	<td><span id="4_7" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(4,7)'></td>
	<td><span id="4_8" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(4,8)'></td>
	<td><span id="4_9" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(4,9)'></td>
      </tr>
      <tr>
	<th>F</th>
	<td><span id="5_0" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(5,0)'></td>
	<td><span id="5_1" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(5,1)'></td>
	<td><span id="5_2" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(5,2)'></td>
	<td><span id="5_3" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(5,3)'></td>
	<td><span id="5_4" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(5,4)'></td>
	<td><span id="5_5" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(5,5)'></td>
	<td><span id="5_6" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(5,6)'></td>
	<td><span id="5_7" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(5,7)'></td>
	<td><span id="5_8" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(5,8)'></td>
	<td><span id="5_9" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(5,9)'></td>
      </tr>
      <tr>
	<th>G</th>
	<td><span id="6_0" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(6,0)'></td>
	<td><span id="6_1" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(6,1)'></td>
	<td><span id="6_2" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(6,2)'></td>
	<td><span id="6_3" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(6,3)'></td>
	<td><span id="6_4" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(6,4)'></td>
	<td><span id="6_5" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(6,5)'></td>
	<td><span id="6_6" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(6,6)'></td>
	<td><span id="6_7" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(6,7)'></td>
	<td><span id="6_8" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(6,8)'></td>
	<td><span id="6_9" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(6,9)'></td>
      </tr>
      <tr>
	<th>H</th>
	<td><span id="7_0" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(7,0)'></td>
	<td><span id="7_1" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(7,1)'></td>
	<td><span id="7_2" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(7,2)'></td>
	<td><span id="7_3" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(7,3)'></td>
	<td><span id="7_4" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(7,4)'></td>
	<td><span id="7_5" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(7,5)'></td>
	<td><span id="7_6" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(7,6)'></td>
	<td><span id="7_7" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(7,7)'></td>
	<td><span id="7_8" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(7,8)'></td>
	<td><span id="7_9" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(7,9)'></td>
      </tr>
      <tr>
	<th>I</th>
	<td><span id="8_0" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(8,0)'></td>
	<td><span id="8_1" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(8,1)'></td>
	<td><span id="8_2" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(8,2)'></td>
	<td><span id="8_3" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(8,3)'></td>
	<td><span id="8_4" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(8,4)'></td>
	<td><span id="8_5" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(8,5)'></td>
	<td><span id="8_6" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(8,6)'></td>
	<td><span id="8_7" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(8,7)'></td>
	<td><span id="8_8" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(8,8)'></td>
	<td><span id="8_9" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(8,9)'></td>
      </tr>
      <tr>
	<th>J</th>
	<td><span id="9_0" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(9,0)'></td>
	<td><span id="9_1" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(9,1)'></td>
	<td><span id="9_2" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(9,2)'></td>
	<td><span id="9_3" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(9,3)'></td>
	<td><span id="9_4" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(9,4)'></td>
	<td><span id="9_5" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(9,5)'></td>
	<td><span id="9_6" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(9,6)'></td>
	<td><span id="9_7" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(9,7)'></td>
	<td><span id="9_8" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(9,8)'></td>
	<td><span id="9_9" class="glyphicon glyphicon-unchecked"
		  aria-hidden="true" onclick='shoot(9,9)'></td>
      </tr>
    </table>
    <br>
    <div>Total Ships: <span id="shipTotal"></span></div>
    <div>Ships sunk: <span id="shipsSunk">None</span></div>
    <div id="gameOver" class="hide">Game Over!</div>
    <script
      src="https://code.jquery.com/jquery-3.2.1.js"
      integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
      crossorigin="anonymous"></script>
    <script>
    var gGame;

function updateCell(obj, el) {
    if (!obj.tag || obj.tag !== "Vacant") {
	console.log("unexpected cell", JSON.stringify(obj));
    }
    else if (obj.contents === null) {
	el.className = 'glyphicon glyphicon-unchecked';
    }
    else if (obj.contents === true) {
	el.className = 'glyphicon glyphicon-certificate hit';
    } else {
	el.className = 'glyphicon glyphicon-certificate';
    }
}


function newGamePromise() {
    return $.post("/game");
}

function shootPromise(row, col) {
    if (gGame) {
//	console.log("Shooting at [" + row + "," + col + "]");
	return $.ajax({
	    url: "/game/" + gGame.handle + "/shoot/" + row + "/" + col,
	    type: "PUT"
	});
    } else {
	return $.Deferred().reject(undefined, "Invalid game");
    }
}

function shoot(row, col) {
    shootPromise(row, col)
	.done(refreshGame)
	.fail(xhrFail);
    return true;
}

function refreshRow(row, rowIndex) {
    //console.log("row", rowIndex, "=", JSON.stringify(row));
    var refreshCell = function(cell, colIndex) {
	// console.log("cell [" + rowIndex + "," + colIndex + "] =",
	//     	    JSON.stringify(cell));
	updateCell(cell, $('#' + rowIndex + '_' + colIndex)[0]);
    };
    row.forEach(refreshCell);
}

function refreshGame(game) {
    if (game && game.board && game.board.board) {
//	console.log(JSON.stringify(game.board));
	gGame = game;
	game.board.board.forEach(refreshRow);
    } else {
	console.log("unexpected: " + JSON.stringify(game));
    }
    $('#shipsSunk').html(game.board.shipsSunk.join(', '));
    $('#shipTotal').html(game.board.shipTotal);
    if (game.board.shipsSunk.length === game.board.shipTotal) {
	$('#gameOver')[0].className = 'show';
    }
}

function xhrFail(xhr, status, errorThrown ) {
    alert( "Sorry, there was a problem!" );
    console.log( "Error: " + errorThrown );
    console.log( "Status: " + status );
    console.dir( xhr );
}

$(document).ready(function() {
    newGamePromise()
	.done(refreshGame)
	.fail(xhrFail);
});
    </script>
</body>
</html>
    
